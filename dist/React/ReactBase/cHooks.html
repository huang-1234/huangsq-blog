<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>3. Hooks 概要学习 | H先森</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    <meta name="description" content="From FE Arch、To Full Stack">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.e16fe094.css" as="style"><link rel="preload" href="/assets/js/app.5b821b5b.js" as="script"><link rel="preload" href="/assets/js/3.bc729665.js" as="script"><link rel="preload" href="/assets/js/1.70674a6e.js" as="script"><link rel="preload" href="/assets/js/367.8febf30a.js" as="script"><link rel="prefetch" href="/assets/js/10.c9f3ea25.js"><link rel="prefetch" href="/assets/js/100.da226559.js"><link rel="prefetch" href="/assets/js/101.1e119a0e.js"><link rel="prefetch" href="/assets/js/102.371333bb.js"><link rel="prefetch" href="/assets/js/103.15f99f6d.js"><link rel="prefetch" href="/assets/js/104.9a1ac228.js"><link rel="prefetch" href="/assets/js/105.afde994c.js"><link rel="prefetch" href="/assets/js/106.9ac11399.js"><link rel="prefetch" href="/assets/js/107.7966ebc1.js"><link rel="prefetch" href="/assets/js/108.f2c40d05.js"><link rel="prefetch" href="/assets/js/109.e3cce79e.js"><link rel="prefetch" href="/assets/js/11.d8a15310.js"><link rel="prefetch" href="/assets/js/110.51af6df9.js"><link rel="prefetch" href="/assets/js/111.71daa04d.js"><link rel="prefetch" href="/assets/js/112.784dd5fd.js"><link rel="prefetch" href="/assets/js/113.f862139c.js"><link rel="prefetch" href="/assets/js/114.974ab134.js"><link rel="prefetch" href="/assets/js/115.1efc1003.js"><link rel="prefetch" href="/assets/js/116.44f6aed9.js"><link rel="prefetch" href="/assets/js/117.d49b1141.js"><link rel="prefetch" href="/assets/js/118.d23c26a1.js"><link rel="prefetch" href="/assets/js/119.8bb969c9.js"><link rel="prefetch" href="/assets/js/12.ac8aba05.js"><link rel="prefetch" href="/assets/js/120.23405a40.js"><link rel="prefetch" href="/assets/js/121.0d830956.js"><link rel="prefetch" href="/assets/js/122.386bb89d.js"><link rel="prefetch" href="/assets/js/123.4d1eafb4.js"><link rel="prefetch" href="/assets/js/124.227c7b10.js"><link rel="prefetch" href="/assets/js/125.0d1a6824.js"><link rel="prefetch" href="/assets/js/126.40a505f0.js"><link rel="prefetch" href="/assets/js/127.77b2e5a8.js"><link rel="prefetch" href="/assets/js/128.4c9d7ca5.js"><link rel="prefetch" href="/assets/js/129.87efe995.js"><link rel="prefetch" href="/assets/js/13.11b9aa70.js"><link rel="prefetch" href="/assets/js/130.4841722f.js"><link rel="prefetch" href="/assets/js/131.e21e111d.js"><link rel="prefetch" href="/assets/js/132.aa1c69d4.js"><link rel="prefetch" href="/assets/js/133.bcf0d73a.js"><link rel="prefetch" href="/assets/js/134.239b9f11.js"><link rel="prefetch" href="/assets/js/135.a9568d70.js"><link rel="prefetch" href="/assets/js/136.47acc927.js"><link rel="prefetch" href="/assets/js/137.ce1c9c40.js"><link rel="prefetch" href="/assets/js/138.6a053ef3.js"><link rel="prefetch" href="/assets/js/139.b82bbb1c.js"><link rel="prefetch" href="/assets/js/14.15db4fd5.js"><link rel="prefetch" href="/assets/js/140.56dc1ab0.js"><link rel="prefetch" href="/assets/js/141.6ff01116.js"><link rel="prefetch" href="/assets/js/142.8b8a9316.js"><link rel="prefetch" href="/assets/js/143.1f0ad4f9.js"><link rel="prefetch" href="/assets/js/144.e195ce40.js"><link rel="prefetch" href="/assets/js/145.2044abb5.js"><link rel="prefetch" href="/assets/js/146.dcdee942.js"><link rel="prefetch" href="/assets/js/147.15d09e85.js"><link rel="prefetch" href="/assets/js/148.d0931843.js"><link rel="prefetch" href="/assets/js/149.e44685a8.js"><link rel="prefetch" href="/assets/js/15.6e8b54da.js"><link rel="prefetch" href="/assets/js/150.0a49468f.js"><link rel="prefetch" href="/assets/js/151.8ca45013.js"><link rel="prefetch" href="/assets/js/152.51f3d577.js"><link rel="prefetch" href="/assets/js/153.caef7d98.js"><link rel="prefetch" href="/assets/js/154.79cfffee.js"><link rel="prefetch" href="/assets/js/155.c79e5402.js"><link rel="prefetch" href="/assets/js/156.c674e912.js"><link rel="prefetch" href="/assets/js/157.4dd421b3.js"><link rel="prefetch" href="/assets/js/158.65cfe834.js"><link rel="prefetch" href="/assets/js/159.c1d1ca0e.js"><link rel="prefetch" href="/assets/js/16.ca6aacff.js"><link rel="prefetch" href="/assets/js/160.405e44e7.js"><link rel="prefetch" href="/assets/js/161.ba8e78c5.js"><link rel="prefetch" href="/assets/js/162.e432e9a2.js"><link rel="prefetch" href="/assets/js/163.1d64eb3e.js"><link rel="prefetch" href="/assets/js/164.5d3619b8.js"><link rel="prefetch" href="/assets/js/165.8e381a63.js"><link rel="prefetch" href="/assets/js/166.1441b3b7.js"><link rel="prefetch" href="/assets/js/167.43b35295.js"><link rel="prefetch" href="/assets/js/168.b076538c.js"><link rel="prefetch" href="/assets/js/169.8e47215a.js"><link rel="prefetch" href="/assets/js/17.b56dcc6f.js"><link rel="prefetch" href="/assets/js/170.6cf64548.js"><link rel="prefetch" href="/assets/js/171.4103462c.js"><link rel="prefetch" href="/assets/js/172.71d4bf28.js"><link rel="prefetch" href="/assets/js/173.9fb9ed0c.js"><link rel="prefetch" href="/assets/js/174.ae41af75.js"><link rel="prefetch" href="/assets/js/175.18870cb0.js"><link rel="prefetch" href="/assets/js/176.84c4ae0a.js"><link rel="prefetch" href="/assets/js/177.41bf6695.js"><link rel="prefetch" href="/assets/js/178.5d0aa178.js"><link rel="prefetch" href="/assets/js/179.9ae9aeff.js"><link rel="prefetch" href="/assets/js/18.3ba55f5a.js"><link rel="prefetch" href="/assets/js/180.4da29ada.js"><link rel="prefetch" href="/assets/js/181.80afa0d3.js"><link rel="prefetch" href="/assets/js/182.3fd29e05.js"><link rel="prefetch" href="/assets/js/183.ecf9a74d.js"><link rel="prefetch" href="/assets/js/184.748374b2.js"><link rel="prefetch" href="/assets/js/185.c38665da.js"><link rel="prefetch" href="/assets/js/186.6f0f97e2.js"><link rel="prefetch" href="/assets/js/187.d03b62d2.js"><link rel="prefetch" href="/assets/js/188.6c70db83.js"><link rel="prefetch" href="/assets/js/189.6678349b.js"><link rel="prefetch" href="/assets/js/19.730a7846.js"><link rel="prefetch" href="/assets/js/190.9fb26e46.js"><link rel="prefetch" href="/assets/js/191.35713cd0.js"><link rel="prefetch" href="/assets/js/192.ad305f17.js"><link rel="prefetch" href="/assets/js/193.fff6f1a7.js"><link rel="prefetch" href="/assets/js/194.90744aa8.js"><link rel="prefetch" href="/assets/js/195.bff0bbbd.js"><link rel="prefetch" href="/assets/js/196.e70ac0a1.js"><link rel="prefetch" href="/assets/js/197.58dad2ea.js"><link rel="prefetch" href="/assets/js/198.57a3844e.js"><link rel="prefetch" href="/assets/js/199.de54e703.js"><link rel="prefetch" href="/assets/js/20.0cb3ac83.js"><link rel="prefetch" href="/assets/js/200.30abfe5b.js"><link rel="prefetch" href="/assets/js/201.ffee503d.js"><link rel="prefetch" href="/assets/js/202.2143a076.js"><link rel="prefetch" href="/assets/js/203.a784f01f.js"><link rel="prefetch" href="/assets/js/204.bdf11491.js"><link rel="prefetch" href="/assets/js/205.7302d46b.js"><link rel="prefetch" href="/assets/js/206.e01ddb36.js"><link rel="prefetch" href="/assets/js/207.5244dc21.js"><link rel="prefetch" href="/assets/js/208.474ee718.js"><link rel="prefetch" href="/assets/js/209.6a728332.js"><link rel="prefetch" href="/assets/js/21.305c8fde.js"><link rel="prefetch" href="/assets/js/210.7dda687f.js"><link rel="prefetch" href="/assets/js/211.e0ce121b.js"><link rel="prefetch" href="/assets/js/212.9ba371b3.js"><link rel="prefetch" href="/assets/js/213.bfb05210.js"><link rel="prefetch" href="/assets/js/214.8f2e742f.js"><link rel="prefetch" href="/assets/js/215.72ece74f.js"><link rel="prefetch" href="/assets/js/216.88150962.js"><link rel="prefetch" href="/assets/js/217.1f330973.js"><link rel="prefetch" href="/assets/js/218.ee7c712c.js"><link rel="prefetch" href="/assets/js/219.18bbc446.js"><link rel="prefetch" href="/assets/js/22.91b25f35.js"><link rel="prefetch" href="/assets/js/220.827d6383.js"><link rel="prefetch" href="/assets/js/221.b2f0406b.js"><link rel="prefetch" href="/assets/js/222.2dfa7c8f.js"><link rel="prefetch" href="/assets/js/223.9e281bd7.js"><link rel="prefetch" href="/assets/js/224.da2ebbb1.js"><link rel="prefetch" href="/assets/js/225.dcc91297.js"><link rel="prefetch" href="/assets/js/226.d9c09086.js"><link rel="prefetch" href="/assets/js/227.af791322.js"><link rel="prefetch" href="/assets/js/228.a1e0f7e7.js"><link rel="prefetch" href="/assets/js/229.c01c2306.js"><link rel="prefetch" href="/assets/js/23.84f8183d.js"><link rel="prefetch" href="/assets/js/230.e2ee3f31.js"><link rel="prefetch" href="/assets/js/231.5673f360.js"><link rel="prefetch" href="/assets/js/232.e2ee3e39.js"><link rel="prefetch" href="/assets/js/233.478b4256.js"><link rel="prefetch" href="/assets/js/234.720cab0a.js"><link rel="prefetch" href="/assets/js/235.86c965e1.js"><link rel="prefetch" href="/assets/js/236.e3eb50a9.js"><link rel="prefetch" href="/assets/js/237.1999f963.js"><link rel="prefetch" href="/assets/js/238.5e1bb6e2.js"><link rel="prefetch" href="/assets/js/239.04fb9831.js"><link rel="prefetch" href="/assets/js/24.602fde60.js"><link rel="prefetch" href="/assets/js/240.8a66ab4e.js"><link rel="prefetch" href="/assets/js/241.a7310c6a.js"><link rel="prefetch" href="/assets/js/242.3863a28a.js"><link rel="prefetch" href="/assets/js/243.187f4b02.js"><link rel="prefetch" href="/assets/js/244.e108b655.js"><link rel="prefetch" href="/assets/js/245.a39d4e37.js"><link rel="prefetch" href="/assets/js/246.da96f4eb.js"><link rel="prefetch" href="/assets/js/247.5afd9cfc.js"><link rel="prefetch" href="/assets/js/248.58cedc79.js"><link rel="prefetch" href="/assets/js/249.ba3e55d6.js"><link rel="prefetch" href="/assets/js/25.335987fe.js"><link rel="prefetch" href="/assets/js/250.64106603.js"><link rel="prefetch" href="/assets/js/251.a1e962a8.js"><link rel="prefetch" href="/assets/js/252.553ae9ac.js"><link rel="prefetch" href="/assets/js/253.06e6e73c.js"><link rel="prefetch" href="/assets/js/254.ca805f70.js"><link rel="prefetch" href="/assets/js/255.750bd959.js"><link rel="prefetch" href="/assets/js/256.b4f306be.js"><link rel="prefetch" href="/assets/js/257.7581915e.js"><link rel="prefetch" href="/assets/js/258.678fbfda.js"><link rel="prefetch" href="/assets/js/259.662a2b24.js"><link rel="prefetch" href="/assets/js/26.bfcf7163.js"><link rel="prefetch" href="/assets/js/260.894553b7.js"><link rel="prefetch" href="/assets/js/261.e8483d2c.js"><link rel="prefetch" href="/assets/js/262.83946674.js"><link rel="prefetch" href="/assets/js/263.2a2eda0b.js"><link rel="prefetch" href="/assets/js/264.d5e0198e.js"><link rel="prefetch" href="/assets/js/265.c09c38c6.js"><link rel="prefetch" href="/assets/js/266.ac96df22.js"><link rel="prefetch" href="/assets/js/267.427b24e9.js"><link rel="prefetch" href="/assets/js/268.84034344.js"><link rel="prefetch" href="/assets/js/269.944ea434.js"><link rel="prefetch" href="/assets/js/27.1f25d9ff.js"><link rel="prefetch" href="/assets/js/270.a33d2bcd.js"><link rel="prefetch" href="/assets/js/271.59a035e9.js"><link rel="prefetch" href="/assets/js/272.9d568a75.js"><link rel="prefetch" href="/assets/js/273.0c219c89.js"><link rel="prefetch" href="/assets/js/274.9c186618.js"><link rel="prefetch" href="/assets/js/275.ad800e82.js"><link rel="prefetch" href="/assets/js/276.60138c53.js"><link rel="prefetch" href="/assets/js/277.37541a7a.js"><link rel="prefetch" href="/assets/js/278.3369d450.js"><link rel="prefetch" href="/assets/js/279.01f43286.js"><link rel="prefetch" href="/assets/js/28.66a8f5e8.js"><link rel="prefetch" href="/assets/js/280.ba6e8b04.js"><link rel="prefetch" href="/assets/js/281.cf764d44.js"><link rel="prefetch" href="/assets/js/282.9973ceae.js"><link rel="prefetch" href="/assets/js/283.74fe0de8.js"><link rel="prefetch" href="/assets/js/284.022061f0.js"><link rel="prefetch" href="/assets/js/285.dbbc87fc.js"><link rel="prefetch" href="/assets/js/286.e7fe1a57.js"><link rel="prefetch" href="/assets/js/287.564fe1ee.js"><link rel="prefetch" href="/assets/js/288.74809121.js"><link rel="prefetch" href="/assets/js/289.b5475ebc.js"><link rel="prefetch" href="/assets/js/29.9c9a47f7.js"><link rel="prefetch" href="/assets/js/290.6ef17519.js"><link rel="prefetch" href="/assets/js/291.a15cde66.js"><link rel="prefetch" href="/assets/js/292.0ff450b7.js"><link rel="prefetch" href="/assets/js/293.e2069203.js"><link rel="prefetch" href="/assets/js/294.714f5ec1.js"><link rel="prefetch" href="/assets/js/295.c814928e.js"><link rel="prefetch" href="/assets/js/296.c851e20f.js"><link rel="prefetch" href="/assets/js/297.822122db.js"><link rel="prefetch" href="/assets/js/298.522b1d2a.js"><link rel="prefetch" href="/assets/js/299.fd71c9ac.js"><link rel="prefetch" href="/assets/js/30.7e1624e8.js"><link rel="prefetch" href="/assets/js/300.c1fe746f.js"><link rel="prefetch" href="/assets/js/301.87da2eda.js"><link rel="prefetch" href="/assets/js/302.0e9220b1.js"><link rel="prefetch" href="/assets/js/303.e1f6baef.js"><link rel="prefetch" href="/assets/js/304.3dddef60.js"><link rel="prefetch" href="/assets/js/305.7cb8e6ca.js"><link rel="prefetch" href="/assets/js/306.1a9e931d.js"><link rel="prefetch" href="/assets/js/307.2bf23c44.js"><link rel="prefetch" href="/assets/js/308.c299b32d.js"><link rel="prefetch" href="/assets/js/309.5d0338c6.js"><link rel="prefetch" href="/assets/js/31.434661ce.js"><link rel="prefetch" href="/assets/js/310.4873a3ca.js"><link rel="prefetch" href="/assets/js/311.9576a44a.js"><link rel="prefetch" href="/assets/js/312.0fe664a5.js"><link rel="prefetch" href="/assets/js/313.6cf030c0.js"><link rel="prefetch" href="/assets/js/314.c315d19c.js"><link rel="prefetch" href="/assets/js/315.c59eef00.js"><link rel="prefetch" href="/assets/js/316.dbe60010.js"><link rel="prefetch" href="/assets/js/317.cbe8b8d0.js"><link rel="prefetch" href="/assets/js/318.4fe8b264.js"><link rel="prefetch" href="/assets/js/319.4403edd7.js"><link rel="prefetch" href="/assets/js/32.70c5e166.js"><link rel="prefetch" href="/assets/js/320.6c5d5e8f.js"><link rel="prefetch" href="/assets/js/321.e627bbe4.js"><link rel="prefetch" href="/assets/js/322.5a02395c.js"><link rel="prefetch" href="/assets/js/323.369d2e68.js"><link rel="prefetch" href="/assets/js/324.ec8de19e.js"><link rel="prefetch" href="/assets/js/325.785774ca.js"><link rel="prefetch" href="/assets/js/326.c554fd6c.js"><link rel="prefetch" href="/assets/js/327.6218c4df.js"><link rel="prefetch" href="/assets/js/328.07d98f8b.js"><link rel="prefetch" href="/assets/js/329.fe3c8e46.js"><link rel="prefetch" href="/assets/js/33.0af0391d.js"><link rel="prefetch" href="/assets/js/330.7123d8dc.js"><link rel="prefetch" href="/assets/js/331.b5c223a1.js"><link rel="prefetch" href="/assets/js/332.0a73f90c.js"><link rel="prefetch" href="/assets/js/333.743b48fb.js"><link rel="prefetch" href="/assets/js/334.1c16e645.js"><link rel="prefetch" href="/assets/js/335.0590dc8c.js"><link rel="prefetch" href="/assets/js/336.ab4021d8.js"><link rel="prefetch" href="/assets/js/337.35621ff9.js"><link rel="prefetch" href="/assets/js/338.545f58c2.js"><link rel="prefetch" href="/assets/js/339.ea6c8d20.js"><link rel="prefetch" href="/assets/js/34.2c73be5a.js"><link rel="prefetch" href="/assets/js/340.c57b35cc.js"><link rel="prefetch" href="/assets/js/341.8f5d714f.js"><link rel="prefetch" href="/assets/js/342.2026d066.js"><link rel="prefetch" href="/assets/js/343.5f98e91a.js"><link rel="prefetch" href="/assets/js/344.524616a5.js"><link rel="prefetch" href="/assets/js/345.26e480f8.js"><link rel="prefetch" href="/assets/js/346.3ab4603e.js"><link rel="prefetch" href="/assets/js/347.31cc6422.js"><link rel="prefetch" href="/assets/js/348.683db559.js"><link rel="prefetch" href="/assets/js/349.8b9ae420.js"><link rel="prefetch" href="/assets/js/35.68433a7b.js"><link rel="prefetch" href="/assets/js/350.038e415c.js"><link rel="prefetch" href="/assets/js/351.fe74cbb2.js"><link rel="prefetch" href="/assets/js/352.f3cecc7c.js"><link rel="prefetch" href="/assets/js/353.f5f66741.js"><link rel="prefetch" href="/assets/js/354.2b32b2c8.js"><link rel="prefetch" href="/assets/js/355.f9198ff2.js"><link rel="prefetch" href="/assets/js/356.2512a59a.js"><link rel="prefetch" href="/assets/js/357.621454f7.js"><link rel="prefetch" href="/assets/js/358.eeba6211.js"><link rel="prefetch" href="/assets/js/359.6c8637d1.js"><link rel="prefetch" href="/assets/js/36.dd53f2bc.js"><link rel="prefetch" href="/assets/js/360.2ca2af94.js"><link rel="prefetch" href="/assets/js/361.c22ebb58.js"><link rel="prefetch" href="/assets/js/362.0408ef83.js"><link rel="prefetch" href="/assets/js/363.331a51d3.js"><link rel="prefetch" href="/assets/js/364.368625e6.js"><link rel="prefetch" href="/assets/js/365.1910a370.js"><link rel="prefetch" href="/assets/js/366.db430d50.js"><link rel="prefetch" href="/assets/js/368.ab309844.js"><link rel="prefetch" href="/assets/js/369.19e33a62.js"><link rel="prefetch" href="/assets/js/37.d4b60d55.js"><link rel="prefetch" href="/assets/js/370.5172907f.js"><link rel="prefetch" href="/assets/js/371.dafd631b.js"><link rel="prefetch" href="/assets/js/372.7751999e.js"><link rel="prefetch" href="/assets/js/373.1091bd69.js"><link rel="prefetch" href="/assets/js/374.bd00083d.js"><link rel="prefetch" href="/assets/js/375.031b3571.js"><link rel="prefetch" href="/assets/js/376.c3a82b30.js"><link rel="prefetch" href="/assets/js/377.736685b0.js"><link rel="prefetch" href="/assets/js/378.6bf4e3bc.js"><link rel="prefetch" href="/assets/js/379.cfb58159.js"><link rel="prefetch" href="/assets/js/38.ce6382f3.js"><link rel="prefetch" href="/assets/js/380.bfe273da.js"><link rel="prefetch" href="/assets/js/381.e4460bcb.js"><link rel="prefetch" href="/assets/js/382.64e9e38b.js"><link rel="prefetch" href="/assets/js/383.5e9a5dab.js"><link rel="prefetch" href="/assets/js/384.f729e041.js"><link rel="prefetch" href="/assets/js/385.87d1415c.js"><link rel="prefetch" href="/assets/js/386.5998a6d1.js"><link rel="prefetch" href="/assets/js/387.115dec7c.js"><link rel="prefetch" href="/assets/js/388.3029f841.js"><link rel="prefetch" href="/assets/js/389.b2e0fa18.js"><link rel="prefetch" href="/assets/js/39.d0dadbd9.js"><link rel="prefetch" href="/assets/js/390.1c354ea8.js"><link rel="prefetch" href="/assets/js/391.a474f737.js"><link rel="prefetch" href="/assets/js/392.47994536.js"><link rel="prefetch" href="/assets/js/393.6c7c0cc7.js"><link rel="prefetch" href="/assets/js/394.6d342afd.js"><link rel="prefetch" href="/assets/js/395.96daed54.js"><link rel="prefetch" href="/assets/js/396.979b8462.js"><link rel="prefetch" href="/assets/js/397.8aaebea3.js"><link rel="prefetch" href="/assets/js/398.67924684.js"><link rel="prefetch" href="/assets/js/399.b5cc34fe.js"><link rel="prefetch" href="/assets/js/4.9cf135a6.js"><link rel="prefetch" href="/assets/js/40.9fbfe4ed.js"><link rel="prefetch" href="/assets/js/400.2537ddd1.js"><link rel="prefetch" href="/assets/js/401.8c92f114.js"><link rel="prefetch" href="/assets/js/402.17edfcf2.js"><link rel="prefetch" href="/assets/js/403.089b01c9.js"><link rel="prefetch" href="/assets/js/404.00804c1b.js"><link rel="prefetch" href="/assets/js/405.515490ce.js"><link rel="prefetch" href="/assets/js/406.3a436bbf.js"><link rel="prefetch" href="/assets/js/407.28c0ec04.js"><link rel="prefetch" href="/assets/js/408.c95b0bcf.js"><link rel="prefetch" href="/assets/js/409.45663b5c.js"><link rel="prefetch" href="/assets/js/41.f3a6dd99.js"><link rel="prefetch" href="/assets/js/410.286eeddf.js"><link rel="prefetch" href="/assets/js/411.b08d3723.js"><link rel="prefetch" href="/assets/js/412.247021e6.js"><link rel="prefetch" href="/assets/js/413.e7c6d9ab.js"><link rel="prefetch" href="/assets/js/414.24527c03.js"><link rel="prefetch" href="/assets/js/415.f2900fd5.js"><link rel="prefetch" href="/assets/js/416.707ef291.js"><link rel="prefetch" href="/assets/js/417.e01cbefa.js"><link rel="prefetch" href="/assets/js/418.5cddcca7.js"><link rel="prefetch" href="/assets/js/419.85bf2d8f.js"><link rel="prefetch" href="/assets/js/42.7b100d43.js"><link rel="prefetch" href="/assets/js/420.c6f3a825.js"><link rel="prefetch" href="/assets/js/421.616680ca.js"><link rel="prefetch" href="/assets/js/422.074aee78.js"><link rel="prefetch" href="/assets/js/423.e5bc242b.js"><link rel="prefetch" href="/assets/js/424.8c0a4a35.js"><link rel="prefetch" href="/assets/js/425.3abf71f1.js"><link rel="prefetch" href="/assets/js/426.d973afcc.js"><link rel="prefetch" href="/assets/js/427.0237eec5.js"><link rel="prefetch" href="/assets/js/428.eed6c498.js"><link rel="prefetch" href="/assets/js/429.6ebdebb8.js"><link rel="prefetch" href="/assets/js/43.fa496207.js"><link rel="prefetch" href="/assets/js/430.0b09093a.js"><link rel="prefetch" href="/assets/js/431.e3790425.js"><link rel="prefetch" href="/assets/js/432.5a1fafcf.js"><link rel="prefetch" href="/assets/js/433.5a57f2e1.js"><link rel="prefetch" href="/assets/js/434.dead7e58.js"><link rel="prefetch" href="/assets/js/435.500efa0b.js"><link rel="prefetch" href="/assets/js/436.28e57f3d.js"><link rel="prefetch" href="/assets/js/437.00cf8693.js"><link rel="prefetch" href="/assets/js/438.a81a0786.js"><link rel="prefetch" href="/assets/js/439.c76f5eb2.js"><link rel="prefetch" href="/assets/js/44.5ba1316c.js"><link rel="prefetch" href="/assets/js/440.eaa9ce9f.js"><link rel="prefetch" href="/assets/js/441.40ed041d.js"><link rel="prefetch" href="/assets/js/442.74bd8041.js"><link rel="prefetch" href="/assets/js/443.927f365d.js"><link rel="prefetch" href="/assets/js/444.edb21ac8.js"><link rel="prefetch" href="/assets/js/445.88d28b92.js"><link rel="prefetch" href="/assets/js/446.e4c95c36.js"><link rel="prefetch" href="/assets/js/447.084e5daa.js"><link rel="prefetch" href="/assets/js/448.e9583bbb.js"><link rel="prefetch" href="/assets/js/449.8fba14e6.js"><link rel="prefetch" href="/assets/js/45.2fabcbed.js"><link rel="prefetch" href="/assets/js/450.030b04a0.js"><link rel="prefetch" href="/assets/js/451.befced82.js"><link rel="prefetch" href="/assets/js/452.dda75d02.js"><link rel="prefetch" href="/assets/js/453.64d5fe2e.js"><link rel="prefetch" href="/assets/js/454.0530851d.js"><link rel="prefetch" href="/assets/js/455.2c96e83e.js"><link rel="prefetch" href="/assets/js/456.85b2ab7b.js"><link rel="prefetch" href="/assets/js/457.371dd35d.js"><link rel="prefetch" href="/assets/js/458.32ebadbc.js"><link rel="prefetch" href="/assets/js/459.717cf8c7.js"><link rel="prefetch" href="/assets/js/46.22324749.js"><link rel="prefetch" href="/assets/js/460.b38358e3.js"><link rel="prefetch" href="/assets/js/461.815225fa.js"><link rel="prefetch" href="/assets/js/462.5da9983e.js"><link rel="prefetch" href="/assets/js/463.b01213b2.js"><link rel="prefetch" href="/assets/js/464.6828aa73.js"><link rel="prefetch" href="/assets/js/465.25f75095.js"><link rel="prefetch" href="/assets/js/466.62524b3c.js"><link rel="prefetch" href="/assets/js/467.b4ceea14.js"><link rel="prefetch" href="/assets/js/468.8c5a0834.js"><link rel="prefetch" href="/assets/js/469.eae4302c.js"><link rel="prefetch" href="/assets/js/47.6bbfc7b5.js"><link rel="prefetch" href="/assets/js/470.fd8219ab.js"><link rel="prefetch" href="/assets/js/471.c58ec86c.js"><link rel="prefetch" href="/assets/js/472.4d5563f4.js"><link rel="prefetch" href="/assets/js/473.ebfe0dab.js"><link rel="prefetch" href="/assets/js/474.df6d03d2.js"><link rel="prefetch" href="/assets/js/475.2ce21434.js"><link rel="prefetch" href="/assets/js/476.dd599d22.js"><link rel="prefetch" href="/assets/js/477.03351463.js"><link rel="prefetch" href="/assets/js/478.706b9a17.js"><link rel="prefetch" href="/assets/js/479.6527b4c1.js"><link rel="prefetch" href="/assets/js/48.02f54e2e.js"><link rel="prefetch" href="/assets/js/480.f3c3a239.js"><link rel="prefetch" href="/assets/js/481.ccc3df9c.js"><link rel="prefetch" href="/assets/js/482.323440f3.js"><link rel="prefetch" href="/assets/js/483.1d7c9006.js"><link rel="prefetch" href="/assets/js/484.93d952d0.js"><link rel="prefetch" href="/assets/js/485.c9ff269c.js"><link rel="prefetch" href="/assets/js/486.363ff08a.js"><link rel="prefetch" href="/assets/js/487.df8b448d.js"><link rel="prefetch" href="/assets/js/488.81cf5ccc.js"><link rel="prefetch" href="/assets/js/489.74391572.js"><link rel="prefetch" href="/assets/js/49.5d1f082a.js"><link rel="prefetch" href="/assets/js/490.e13a23ad.js"><link rel="prefetch" href="/assets/js/491.2ce4b0e2.js"><link rel="prefetch" href="/assets/js/492.443b472d.js"><link rel="prefetch" href="/assets/js/493.82126d2f.js"><link rel="prefetch" href="/assets/js/494.14d7dce7.js"><link rel="prefetch" href="/assets/js/495.ea095766.js"><link rel="prefetch" href="/assets/js/496.858167a1.js"><link rel="prefetch" href="/assets/js/497.cbadb3c9.js"><link rel="prefetch" href="/assets/js/498.97c3e466.js"><link rel="prefetch" href="/assets/js/499.2a2d86c2.js"><link rel="prefetch" href="/assets/js/5.10f74df8.js"><link rel="prefetch" href="/assets/js/50.92c19929.js"><link rel="prefetch" href="/assets/js/500.13c578ee.js"><link rel="prefetch" href="/assets/js/501.32a3254f.js"><link rel="prefetch" href="/assets/js/502.eef016a7.js"><link rel="prefetch" href="/assets/js/503.f47d93de.js"><link rel="prefetch" href="/assets/js/504.5098665f.js"><link rel="prefetch" href="/assets/js/505.0a129912.js"><link rel="prefetch" href="/assets/js/506.787adcc5.js"><link rel="prefetch" href="/assets/js/507.a63b8e6a.js"><link rel="prefetch" href="/assets/js/508.3ff38a06.js"><link rel="prefetch" href="/assets/js/509.6ccd9947.js"><link rel="prefetch" href="/assets/js/51.b33d9099.js"><link rel="prefetch" href="/assets/js/510.6167e211.js"><link rel="prefetch" href="/assets/js/511.26c5de1c.js"><link rel="prefetch" href="/assets/js/512.5775f3ef.js"><link rel="prefetch" href="/assets/js/513.77bd836a.js"><link rel="prefetch" href="/assets/js/514.eac7e150.js"><link rel="prefetch" href="/assets/js/515.74d67a34.js"><link rel="prefetch" href="/assets/js/516.51cd41c0.js"><link rel="prefetch" href="/assets/js/517.8bd41aea.js"><link rel="prefetch" href="/assets/js/518.52922e2b.js"><link rel="prefetch" href="/assets/js/519.324b1f10.js"><link rel="prefetch" href="/assets/js/52.055a12da.js"><link rel="prefetch" href="/assets/js/520.d7dc71eb.js"><link rel="prefetch" href="/assets/js/521.70ca573a.js"><link rel="prefetch" href="/assets/js/522.2171444f.js"><link rel="prefetch" href="/assets/js/523.5dcf8990.js"><link rel="prefetch" href="/assets/js/524.bd0da2f2.js"><link rel="prefetch" href="/assets/js/525.38f3239f.js"><link rel="prefetch" href="/assets/js/526.05c4d102.js"><link rel="prefetch" href="/assets/js/527.d66cc3d4.js"><link rel="prefetch" href="/assets/js/528.910adad4.js"><link rel="prefetch" href="/assets/js/529.c53f4e0a.js"><link rel="prefetch" href="/assets/js/53.7e42f875.js"><link rel="prefetch" href="/assets/js/530.3d92b51e.js"><link rel="prefetch" href="/assets/js/531.559ca026.js"><link rel="prefetch" href="/assets/js/532.35e8b50c.js"><link rel="prefetch" href="/assets/js/533.24144a04.js"><link rel="prefetch" href="/assets/js/534.354a2bc9.js"><link rel="prefetch" href="/assets/js/535.efc1e869.js"><link rel="prefetch" href="/assets/js/536.1e46892b.js"><link rel="prefetch" href="/assets/js/537.6a401270.js"><link rel="prefetch" href="/assets/js/538.ac6b3a34.js"><link rel="prefetch" href="/assets/js/539.a39c948a.js"><link rel="prefetch" href="/assets/js/54.837cb217.js"><link rel="prefetch" href="/assets/js/540.328b68fc.js"><link rel="prefetch" href="/assets/js/541.3b8fcd25.js"><link rel="prefetch" href="/assets/js/542.f5c21510.js"><link rel="prefetch" href="/assets/js/543.8f607bc4.js"><link rel="prefetch" href="/assets/js/544.919b43be.js"><link rel="prefetch" href="/assets/js/545.5bdf997f.js"><link rel="prefetch" href="/assets/js/546.55172e1a.js"><link rel="prefetch" href="/assets/js/547.0e48df25.js"><link rel="prefetch" href="/assets/js/548.eaf3c080.js"><link rel="prefetch" href="/assets/js/549.fa3e8364.js"><link rel="prefetch" href="/assets/js/55.6f8711a2.js"><link rel="prefetch" href="/assets/js/550.d834b6b6.js"><link rel="prefetch" href="/assets/js/551.29b88fb2.js"><link rel="prefetch" href="/assets/js/552.adbeb34a.js"><link rel="prefetch" href="/assets/js/553.520ad149.js"><link rel="prefetch" href="/assets/js/554.d9f2af8b.js"><link rel="prefetch" href="/assets/js/555.99eb10b3.js"><link rel="prefetch" href="/assets/js/56.b6716444.js"><link rel="prefetch" href="/assets/js/57.b6cba518.js"><link rel="prefetch" href="/assets/js/58.111c3525.js"><link rel="prefetch" href="/assets/js/59.a8eaf777.js"><link rel="prefetch" href="/assets/js/6.c88ff3b3.js"><link rel="prefetch" href="/assets/js/60.17ca08bf.js"><link rel="prefetch" href="/assets/js/61.85d98041.js"><link rel="prefetch" href="/assets/js/62.cd357510.js"><link rel="prefetch" href="/assets/js/63.b7eca665.js"><link rel="prefetch" href="/assets/js/64.4eebb67a.js"><link rel="prefetch" href="/assets/js/65.6d1df6a5.js"><link rel="prefetch" href="/assets/js/66.d981e45c.js"><link rel="prefetch" href="/assets/js/67.1249c446.js"><link rel="prefetch" href="/assets/js/68.8072b9e9.js"><link rel="prefetch" href="/assets/js/69.6eca8619.js"><link rel="prefetch" href="/assets/js/7.079dae5b.js"><link rel="prefetch" href="/assets/js/70.e95af45c.js"><link rel="prefetch" href="/assets/js/71.fc89fd98.js"><link rel="prefetch" href="/assets/js/72.1bcbe8c2.js"><link rel="prefetch" href="/assets/js/73.1ffcd9ed.js"><link rel="prefetch" href="/assets/js/74.e22708c3.js"><link rel="prefetch" href="/assets/js/75.ec5a846e.js"><link rel="prefetch" href="/assets/js/76.9ac8a443.js"><link rel="prefetch" href="/assets/js/77.fb476602.js"><link rel="prefetch" href="/assets/js/78.c94912e5.js"><link rel="prefetch" href="/assets/js/79.f75dc3d0.js"><link rel="prefetch" href="/assets/js/8.44bf364c.js"><link rel="prefetch" href="/assets/js/80.0bf5a5e3.js"><link rel="prefetch" href="/assets/js/81.604850a7.js"><link rel="prefetch" href="/assets/js/82.37a6a570.js"><link rel="prefetch" href="/assets/js/83.030cd849.js"><link rel="prefetch" href="/assets/js/84.a614bf11.js"><link rel="prefetch" href="/assets/js/85.c85cc92f.js"><link rel="prefetch" href="/assets/js/86.407ec1ec.js"><link rel="prefetch" href="/assets/js/87.09994aa7.js"><link rel="prefetch" href="/assets/js/88.af4a338d.js"><link rel="prefetch" href="/assets/js/89.b91a3324.js"><link rel="prefetch" href="/assets/js/9.a056cf7b.js"><link rel="prefetch" href="/assets/js/90.7c067507.js"><link rel="prefetch" href="/assets/js/91.335de3ba.js"><link rel="prefetch" href="/assets/js/92.02fa6ef8.js"><link rel="prefetch" href="/assets/js/93.3cd4b5a9.js"><link rel="prefetch" href="/assets/js/94.2222e0f0.js"><link rel="prefetch" href="/assets/js/95.2f9c965e.js"><link rel="prefetch" href="/assets/js/96.8f9df607.js"><link rel="prefetch" href="/assets/js/97.465c9ed4.js"><link rel="prefetch" href="/assets/js/98.f8026ccd.js"><link rel="prefetch" href="/assets/js/99.a0991c76.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e16fe094.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>H先森</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>From FE Arch、To Full Stack</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>huangsq</span>
            
          <!---->
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/me.jpg" alt="H先森" class="logo"> <span class="site-name">H先森</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      FE
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JS/" class="nav-link"><i class="undefined"></i>
  JS
</a></li><li class="dropdown-item"><!----> <a href="/HTML/" class="nav-link"><i class="undefined"></i>
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/Styles/" class="nav-link"><i class="undefined"></i>
  Styles
</a></li><li class="dropdown-item"><!----> <a href="/TS/" class="nav-link"><i class="undefined"></i>
  TS
</a></li><li class="dropdown-item"><h4>Browser</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/BrowserCore/" class="nav-link"><i class="undefined"></i>
  BrCore(MP)
</a></li><li class="dropdown-subitem"><a href="/BrowserModel/" class="nav-link"><i class="undefined"></i>
  BrModel(MT)
</a></li></ul></li><li class="dropdown-item"><h4>Web</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/WebAPI/" class="nav-link"><i class="undefined"></i>
  WebAPI
</a></li><li class="dropdown-subitem"><a href="/WebStandard/" class="nav-link"><i class="undefined"></i>
  WebStandard
</a></li></ul></li><li class="dropdown-item"><h4>JQuery</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/JQuery/" class="nav-link"><i class="undefined"></i>
  JQueryBase
</a></li></ul></li><li class="dropdown-item"><h4>Angular</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Angular/" class="nav-link"><i class="undefined"></i>
  AngularBase
</a></li></ul></li><li class="dropdown-item"><h4>React</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/React/" class="nav-link router-link-active"><i class="undefined"></i>
  ReactBase
</a></li></ul></li><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/" class="nav-link"><i class="undefined"></i>
  VueBase
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      BE
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Nodejs</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/BE/" class="nav-link"><i class="undefined"></i>
  NodeBase
</a></li></ul></li><li class="dropdown-item"><h4>cPlus</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Cplus/" class="nav-link"><i class="undefined"></i>
  cPlus
</a></li></ul></li><li class="dropdown-item"><h4>Go</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Go/" class="nav-link"><i class="undefined"></i>
  Go
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Proj
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/" class="nav-link"><i class="undefined"></i>
  Project
</a></li><li class="dropdown-item"><h4>toolsForProject</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Tools/" class="nav-link"><i class="undefined"></i>
  Git&amp;webpack
</a></li></ul></li><li class="dropdown-item"><h4>other-ology</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/OtherOlogy/" class="nav-link"><i class="undefined"></i>
  English
</a></li></ul></li><li class="dropdown-item"><h4>W</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Interface/" class="nav-link"><i class="undefined"></i>
  interfaceEx
</a></li></ul></li><li class="dropdown-item"><h4>AI</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/AlgorithmAI/" class="nav-link"><i class="undefined"></i>
  AI
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      csBase
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CSBase/" class="nav-link"><i class="undefined"></i>
  CSBase
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/me.jpg" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    huangsq
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>520</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>0</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      FE
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JS/" class="nav-link"><i class="undefined"></i>
  JS
</a></li><li class="dropdown-item"><!----> <a href="/HTML/" class="nav-link"><i class="undefined"></i>
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/Styles/" class="nav-link"><i class="undefined"></i>
  Styles
</a></li><li class="dropdown-item"><!----> <a href="/TS/" class="nav-link"><i class="undefined"></i>
  TS
</a></li><li class="dropdown-item"><h4>Browser</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/BrowserCore/" class="nav-link"><i class="undefined"></i>
  BrCore(MP)
</a></li><li class="dropdown-subitem"><a href="/BrowserModel/" class="nav-link"><i class="undefined"></i>
  BrModel(MT)
</a></li></ul></li><li class="dropdown-item"><h4>Web</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/WebAPI/" class="nav-link"><i class="undefined"></i>
  WebAPI
</a></li><li class="dropdown-subitem"><a href="/WebStandard/" class="nav-link"><i class="undefined"></i>
  WebStandard
</a></li></ul></li><li class="dropdown-item"><h4>JQuery</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/JQuery/" class="nav-link"><i class="undefined"></i>
  JQueryBase
</a></li></ul></li><li class="dropdown-item"><h4>Angular</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Angular/" class="nav-link"><i class="undefined"></i>
  AngularBase
</a></li></ul></li><li class="dropdown-item"><h4>React</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/React/" class="nav-link router-link-active"><i class="undefined"></i>
  ReactBase
</a></li></ul></li><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Vue/" class="nav-link"><i class="undefined"></i>
  VueBase
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      BE
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Nodejs</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/BE/" class="nav-link"><i class="undefined"></i>
  NodeBase
</a></li></ul></li><li class="dropdown-item"><h4>cPlus</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Cplus/" class="nav-link"><i class="undefined"></i>
  cPlus
</a></li></ul></li><li class="dropdown-item"><h4>Go</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Go/" class="nav-link"><i class="undefined"></i>
  Go
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Proj
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/" class="nav-link"><i class="undefined"></i>
  Project
</a></li><li class="dropdown-item"><h4>toolsForProject</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Tools/" class="nav-link"><i class="undefined"></i>
  Git&amp;webpack
</a></li></ul></li><li class="dropdown-item"><h4>other-ology</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/OtherOlogy/" class="nav-link"><i class="undefined"></i>
  English
</a></li></ul></li><li class="dropdown-item"><h4>W</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Interface/" class="nav-link"><i class="undefined"></i>
  interfaceEx
</a></li></ul></li><li class="dropdown-item"><h4>AI</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/AlgorithmAI/" class="nav-link"><i class="undefined"></i>
  AI
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      csBase
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CSBase/" class="nav-link"><i class="undefined"></i>
  CSBase
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ReactBase</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/React/ReactBase/cHooks.html" aria-current="page" class="active sidebar-link">3. Hooks 概要学习</a></li><li><a href="/React/ReactBase/dRouter.html" class="sidebar-link">4.关于 Router</a></li><li><a href="/React/ReactBase/eLifeFun.html" class="sidebar-link">react 的生命周期函数</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react-api</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>reactExtends</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc></h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>huangsq</span>
            
          <!---->
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">3. Hooks 概要学习</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>huangsq</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="_3-hooks-概要学习"><a href="#_3-hooks-概要学习" class="header-anchor">#</a> 3. Hooks 概要学习</h1> <h2 id="hooks-的由来"><a href="#hooks-的由来" class="header-anchor">#</a> Hooks 的由来</h2> <blockquote><p>先看看 React 官网怎么说：</p></blockquote> <h3 id="在组件之间复用状态逻辑很难"><a href="#在组件之间复用状态逻辑很难" class="header-anchor">#</a> 在组件之间复用状态逻辑很难</h3> <p>React 没有提供将可复用性行为“附加”到组件的途径（例如，把组件连接到 store）。如果你使用过 React 一段时间，你也许会熟悉一些解决此类问题的方案，比如 <a href="https://zh-hans.reactjs.org/docs/render-props.html" target="_blank" rel="noopener noreferrer">render props<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://zh-hans.reactjs.org/docs/higher-order-components.html" target="_blank" rel="noopener noreferrer">高阶组件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。但是这类方案需要重新组织你的组件结构，这可能会很麻烦，使你的代码难以理解。如果你在 React DevTools 中观察过 React 应用，你会发现由 providers，consumers，高阶组件，render props 等其他抽象层组成的组件会形成“嵌套地狱”。尽管我们可以<a href="https://github.com/facebook/react-devtools/pull/503" target="_blank" rel="noopener noreferrer">在 DevTools 过滤掉它们<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，但这说明了一个更深层次的问题：React 需要为共享状态逻辑提供更好的原生途径。</p> <p>你可以使用 Hook 从组件中提取状态逻辑，使得这些逻辑可以单独测试并复用。<strong>Hook 使你在无需修改组件结构的情况下复用状态逻辑。</strong> 这使得在组件间或社区内共享 Hook 变得更便捷。</p> <p>具体将在<a href="https://zh-hans.reactjs.org/docs/hooks-custom.html" target="_blank" rel="noopener noreferrer">自定义 Hook<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中对此展开更多讨论。</p> <h3 id="复杂组件变得难以理解"><a href="#复杂组件变得难以理解" class="header-anchor">#</a> 复杂组件变得难以理解</h3> <p>我们经常维护一些组件，组件起初很简单，但是逐渐会被状态逻辑和副作用充斥。每个生命周期常常包含一些不相关的逻辑。例如，组件常常在 <code>componentDidMount</code> 和 <code>componentDidUpdate</code> 中获取数据。但是，同一个 <code>componentDidMount</code> 中可能也包含很多其它的逻辑，如设置事件监听，而之后需在 <code>componentWillUnmount</code> 中清除。相互关联且需要对照修改的代码被进行了拆分，而完全不相关的代码却在同一个方法中组合在一起。如此很容易产生 bug，并且导致逻辑不一致。</p> <p>在多数情况下，不可能将组件拆分为更小的粒度，因为状态逻辑无处不在。这也给测试带来了一定挑战。同时，这也是很多人将 React 与状态管理库结合使用的原因之一。但是，这往往会引入了很多抽象概念，需要你在不同的文件之间来回切换，使得复用变得更加困难。</p> <p>为了解决这个问题，<strong>Hook 将组件中相互关联的部分拆分成更小的函数（比如设置订阅或请求数据）</strong>，而并非强制按照生命周期划分。你还可以使用 reducer 来管理组件的内部状态，使其更加可预测。</p> <h2 id="解决问题而出现"><a href="#解决问题而出现" class="header-anchor">#</a> 解决问题而出现</h2> <p><code>Hooks</code>的出现是为了解决 React 长久以来存在的一些问题：</p> <ul><li>带组件状态的逻辑很难重用</li></ul> <p>为了解决这个问题，需要引入<code>render props</code>或<code>higher-order components</code>这样的设计模式，如<code>react-redux</code>提供的<code>connect</code>方法。这种方案不够直观，而且需要改变组件的层级结构，极端情况下会有多个<code>wrapper</code>嵌套调用的情况。</p> <p><code>Hooks</code>可以在不改变组件层级关系的前提下，方便的重用带状态的逻辑。</p> <ul><li>复杂组件难于理解</li></ul> <p>大量的业务逻辑需要放在<code>componentDidMount</code>和<code>componentDidUpdate</code>等生命周期函数中，而且往往一个生命周期函数中会包含多个不相关的业务逻辑，如日志记录和数据请求会同时放在<code>componentDidMount</code>中。另一方面，相关的业务逻辑也有可能会放在不同的生命周期函数中，如组件挂载的时候订阅事件，卸载的时候取消订阅，就需要同时在<code>componentDidMount</code>和<code>componentWillUnmount</code>中写相关逻辑。</p> <p><code>Hooks</code>可以封装相关联的业务逻辑，让代码结构更加清晰。</p> <ul><li>难于理解的 Class 组件</li></ul> <p>JS 中的<code>this</code>关键字让不少人吃过苦头，它的取值与其它面向对象语言都不一样，是在运行时决定的。为了解决这一痛点，才会有剪头函数的<code>this</code>绑定特性。另外 React 中还有<code>Class Component</code>和<code>Function Component</code>的概念，什么时候应该用什么组件也是一件纠结的事情。代码优化方面，对<code>Class Component</code>进行预编译和压缩会比普通函数困难得多，而且还容易出问题。</p> <p><code>Hooks</code>可以在不引入 Class 的前提下，使用 React 的各种特性。</p> <h2 id="_1-setstate-更新状态的-2-种写法"><a href="#_1-setstate-更新状态的-2-种写法" class="header-anchor">#</a> 1. setState 更新状态的 2 种写法</h2> <div class="language-js extra-class"><pre class="language-js"><code>	<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token function">setState</span><span class="token punctuation">(</span>stateChange<span class="token punctuation">,</span> <span class="token punctuation">[</span>callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>对象式的setState
    <span class="token number">1.</span><span class="token function">stateChange为状态改变对象</span><span class="token punctuation">(</span>该对象可以体现出状态的更改<span class="token punctuation">)</span>
    <span class="token number">2.</span>callback是可选的回调函数<span class="token punctuation">,</span> <span class="token function">它在状态更新完毕、界面也更新后</span><span class="token punctuation">(</span>render调用后<span class="token punctuation">)</span><span class="token function">才被调用</span>

	<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token function">setState</span><span class="token punctuation">(</span>updater<span class="token punctuation">,</span> <span class="token punctuation">[</span>callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>函数式的setState
    <span class="token number">1.</span>updater为返回stateChange对象的函数。
    <span class="token number">2.</span>updater可以接收到state和props。
    <span class="token number">4.</span>callback是可选的回调函数<span class="token punctuation">,</span> <span class="token function">它在状态更新、界面也更新后</span><span class="token punctuation">(</span>render调用后<span class="token punctuation">)</span>才被调用。
总结<span class="token operator">:</span>
		<span class="token number">1.</span><span class="token function">对象式的setState是函数式的setState的简写方式</span><span class="token punctuation">(</span>语法糖<span class="token punctuation">)</span>
		<span class="token number">2.</span><span class="token function">使用原则：</span>
      <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>如果新状态不依赖于原状态 <span class="token operator">===</span><span class="token operator">&gt;</span> <span class="token function">使用对象方式</span>
      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>如果新状态依赖于原状态 <span class="token operator">===</span><span class="token operator">&gt;</span> <span class="token function">使用函数方式</span>
      <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">如果需要在setState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>执行后获取最新的状态数据<span class="token punctuation">,</span>要在第二个callback函数中读取
</code></pre></div><h2 id="_2-lazyload"><a href="#_2-lazyload" class="header-anchor">#</a> 2. lazyLoad</h2> <h3 id="路由组件的-lazyload"><a href="#路由组件的-lazyload" class="header-anchor">#</a> 路由组件的 lazyLoad</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code>	<span class="token comment">//1.通过React的lazy函数配合import()函数动态加载路由组件 ===&gt; 路由组件代码会被分开打包</span>
	<span class="token keyword">const</span> Login <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/pages/Login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment">//2.通过&lt;Suspense&gt;指定在加载得到路由打包文件前显示一个自定义loading界面</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Suspense</span></span> <span class="token attr-name">fallback</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">loading.....</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Switch</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/xxx<span class="token punctuation">&quot;</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>Xxxx<span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Redirect</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/login<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Switch</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Suspense</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><hr> <h2 id="_3-hooks"><a href="#_3-hooks" class="header-anchor">#</a> 3. Hooks</h2> <h4 id="_1-react-hook-hooks-是什么"><a href="#_1-react-hook-hooks-是什么" class="header-anchor">#</a> 1. React Hook/Hooks 是什么?</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span> Hook是React <span class="token number">16.8</span><span class="token number">.0</span>版本增加的新特性<span class="token operator">/</span><span class="token function">新语法</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span> 可以让你在函数组件中使用 state 以及其他的 React 特性
</code></pre></div><h4 id="_2-三个常用的-hook"><a href="#_2-三个常用的-hook" class="header-anchor">#</a> 2. 三个常用的 Hook</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span> State Hook<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span> Effect Hook<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span> Ref Hook<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-state-hook"><a href="#_3-state-hook" class="header-anchor">#</a> 3. State Hook</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span> State Hook让函数组件也可以有state状态<span class="token punctuation">,</span> <span class="token function">并进行状态数据的读写操作</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span> 语法<span class="token operator">:</span> <span class="token keyword">const</span> <span class="token punctuation">[</span>xxx<span class="token punctuation">,</span> setXxx<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span>initValue<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>说明<span class="token operator">:</span>
      参数<span class="token operator">:</span> 第一次初始化指定的值在内部作缓存
      返回值<span class="token operator">:</span> 包含<span class="token number">2</span>个元素的数组<span class="token punctuation">,</span> 第<span class="token number">1</span>个为内部当前状态值<span class="token punctuation">,</span> <span class="token function">第2个为更新状态值的函数</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token function">setXxx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token number">2</span>种写法<span class="token operator">:</span>
      <span class="token function">setXxx</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token operator">:</span> 参数为非函数值<span class="token punctuation">,</span> 直接指定新的状态值<span class="token punctuation">,</span> 内部用其覆盖原来的状态值
      <span class="token function">setXxx</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> newValue<span class="token punctuation">)</span><span class="token operator">:</span> 参数为函数<span class="token punctuation">,</span> 接收原本的状态值<span class="token punctuation">,</span> 返回新的状态值<span class="token punctuation">,</span> 内部用其覆盖原来的状态值
</code></pre></div><h4 id="_4-effect-hook"><a href="#_4-effect-hook" class="header-anchor">#</a> 4. Effect Hook</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span> Effect Hook <span class="token function">可以让你在函数组件中执行副作用操作</span><span class="token punctuation">(</span>用于模拟类组件中的生命周期钩子<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span> React中的副作用操作<span class="token operator">:</span>
    发ajax请求数据获取
    设置订阅 <span class="token operator">/</span> 启动定时器
    手动更改真实<span class="token constant">DOM</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span> 语法和说明<span class="token operator">:</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 在此可以执行任何带副作用操作</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 在组件卸载前执行</span>
        <span class="token comment">// 在此做一些收尾工作, 比如清除定时器/取消订阅等</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>stateValue<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 如果指定的是[], 回调函数只会在第一次render()后执行</span>

<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span> 可以把 useEffect Hook 看做如下三个函数的组合
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_5-ref-hook"><a href="#_5-ref-hook" class="header-anchor">#</a> 5. Ref Hook</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span> Ref Hook可以在函数组件中存储<span class="token operator">/</span><span class="token function">查找组件内的标签或任意其它数据</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span> 语法<span class="token operator">:</span> <span class="token keyword">const</span> refContainer <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span> 作用<span class="token operator">:</span>保存标签对象<span class="token punctuation">,</span>功能与React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>一样
</code></pre></div><hr> <h2 id="_4-fragment"><a href="#_4-fragment" class="header-anchor">#</a> 4. Fragment</h2> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <div class="language- extra-class"><pre><code>&lt;Fragment&gt;&lt;Fragment&gt;
&lt;&gt;&lt;/&gt;
</code></pre></div><h3 id="作用"><a href="#作用" class="header-anchor">#</a> 作用</h3> <blockquote><p>可以不用必须有一个真实的 DOM 根标签了</p></blockquote> <hr> <h2 id="_5-context"><a href="#_5-context" class="header-anchor">#</a> 5. Context</h2> <h3 id="理解"><a href="#理解" class="header-anchor">#</a> 理解</h3> <blockquote><p>一种组件间通信方式, 常用于【祖组件】与【后代组件】间通信</p></blockquote> <h3 id="使用-2"><a href="#使用-2" class="header-anchor">#</a> 使用</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token number">1</span><span class="token punctuation">)</span> 创建Context容器对象：
	<span class="token keyword">const</span> XxxContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token number">2</span><span class="token punctuation">)</span> 渲染子组时，外面包裹xxxContext<span class="token punctuation">.</span>Provider<span class="token punctuation">,</span> 通过value属性给后代组件传递数据：
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xxxContext.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>数据<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
		子组件
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>xxxContext.Provider</span><span class="token punctuation">&gt;</span></span>

<span class="token number">3</span><span class="token punctuation">)</span> 后代组件读取数据：

	<span class="token comment">//第一种方式:仅适用于类组件</span>
	  <span class="token keyword">static</span> contextType <span class="token operator">=</span> xxxContext  <span class="token comment">// 声明接收context</span>
	  <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token comment">// 读取context中的value数据</span>

	<span class="token comment">//第二种方式: 函数组件与类组件都可以</span>
	  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xxxContext.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
	    </span><span class="token punctuation">{</span>
	      <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span> <span class="token comment">// value就是context中的value数据</span>
	        要显示的内容
	      <span class="token punctuation">)</span>
	    <span class="token punctuation">}</span><span class="token plain-text">
	  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>xxxContext.Consumer</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="注意"><a href="#注意" class="header-anchor">#</a> 注意</h3> <div class="language-js extra-class"><pre class="language-js"><code>在应用开发中一般不用context<span class="token punctuation">,</span> 一般都它的封装react插件<span class="token punctuation">;</span>
</code></pre></div><h2 id="_6-组件优化"><a href="#_6-组件优化" class="header-anchor">#</a> 6. 组件优化</h2> <h3 id="component-的-2-个问题"><a href="#component-的-2-个问题" class="header-anchor">#</a> Component 的 2 个问题</h3> <blockquote><ol><li><p>只要执行 setState(),即使不改变状态数据, 组件也会重新 render()</p></li> <li><p>只当前组件重新 render(), 就会自动重新 render 子组件 ==&gt; 效率低</p></li></ol></blockquote> <h3 id="效率高的做法"><a href="#效率高的做法" class="header-anchor">#</a> 效率高的做法</h3> <blockquote><p>只有当组件的 state 或 props 数据发生改变时才重新 render()</p></blockquote> <h3 id="原因"><a href="#原因" class="header-anchor">#</a> 原因</h3> <blockquote><p>Component 中的 shouldComponentUpdate()总是返回 true</p></blockquote> <h3 id="解决"><a href="#解决" class="header-anchor">#</a> 解决</h3> <div class="language-js extra-class"><pre class="language-js"><code>办法<span class="token number">1</span><span class="token operator">:</span>
  <span class="token function">重写shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法
  比较新旧state或props数据<span class="token punctuation">,</span> 如果有变化才返回<span class="token boolean">true</span><span class="token punctuation">,</span> 如果没有返回<span class="token boolean">false</span>
办法<span class="token number">2</span><span class="token operator">:</span>
  使用PureComponent
  <span class="token function">PureComponent重写了shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 只有state或props数据有变化才返回<span class="token boolean">true</span>
  注意<span class="token operator">:</span>
    只是进行state和props数据的浅比较<span class="token punctuation">,</span> 如果只是数据对象内部数据变了<span class="token punctuation">,</span> 返回<span class="token boolean">false</span>
    不要直接修改state数据<span class="token punctuation">,</span> 而是要产生新数据
项目中一般使用PureComponent来优化
</code></pre></div><hr> <h2 id="_7-render-props"><a href="#_7-render-props" class="header-anchor">#</a> 7. render props</h2> <h3 id="如何向组件内部动态传入带内容的结构-标签"><a href="#如何向组件内部动态传入带内容的结构-标签" class="header-anchor">#</a> 如何向组件内部动态传入带内容的结构(标签)?</h3> <div class="language-js extra-class"><pre class="language-js"><code>	Vue中<span class="token operator">:</span>
		使用slot技术<span class="token punctuation">,</span> 也就是通过组件标签体传入结构  <span class="token operator">&lt;</span><span class="token constant">AA</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token constant">BB</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">AA</span><span class="token operator">&gt;</span>
	React中<span class="token operator">:</span>
		使用children props<span class="token operator">:</span> 通过组件标签体传入结构
		使用render props<span class="token operator">:</span> 通过组件标签属性传入结构<span class="token punctuation">,</span> 一般用render函数属性
</code></pre></div><h3 id="children-props"><a href="#children-props" class="header-anchor">#</a> children props</h3> <div class="language-js extra-class"><pre class="language-js"><code>	<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token operator">&gt;</span>
	  <span class="token operator">&lt;</span><span class="token constant">B</span><span class="token operator">&gt;</span>xxxx<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">B</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">A</span><span class="token operator">&gt;</span>
	<span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
	问题<span class="token operator">:</span> 如果<span class="token constant">B</span>组件需要<span class="token constant">A</span>组件内的数据<span class="token punctuation">,</span> <span class="token operator">==</span><span class="token operator">&gt;</span> 做不到
</code></pre></div><h3 id="render-props"><a href="#render-props" class="header-anchor">#</a> render props</h3> <div class="language-js extra-class"><pre class="language-js"><code>	<span class="token operator">&lt;</span><span class="token constant">A</span> render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span><span class="token constant">C</span> data<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">A</span><span class="token operator">&gt;</span>
	<span class="token constant">A</span>组件<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>内部state数据<span class="token punctuation">)</span><span class="token punctuation">}</span>
	<span class="token constant">C</span>组件<span class="token operator">:</span> 读取<span class="token constant">A</span>组件传入的数据显示 <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>data<span class="token punctuation">}</span>

</code></pre></div><h2 id="_8-错误边界"><a href="#_8-错误边界" class="header-anchor">#</a> 8. 错误边界</h2> <h4 id="理解-2"><a href="#理解-2" class="header-anchor">#</a> 理解：</h4> <p>错误边界：用来捕获后代组件错误，渲染出备用页面</p> <h4 id="特点"><a href="#特点" class="header-anchor">#</a> 特点：</h4> <p>只能捕获后代组件生命周期产生的错误，不能捕获自己组件产生的错误和其他组件在合成事件、定时器中产生的错误</p> <h5 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式：</h5> <p>getDerivedStateFromError 配合 componentDidCatch</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 生命周期函数，一旦后台组件报错，就会触发</span>
<span class="token keyword">static</span> <span class="token function">getDerivedStateFromError</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 在render之前触发</span>
    <span class="token comment">// 返回新的state</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        hasError<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">componentDidCatch</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 统计页面的错误。发送请求发送到后台去</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-组件通信方式总结"><a href="#_9-组件通信方式总结" class="header-anchor">#</a> 9. 组件通信方式总结</h2> <h4 id="方式"><a href="#方式" class="header-anchor">#</a> 方式：</h4> <div class="language-js extra-class"><pre class="language-js"><code>	<span class="token function">props：</span>
		<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>children <span class="token function">props</span>
		<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render props
	消息订阅<span class="token operator">-</span>发布：
		pubs<span class="token operator">-</span>sub、event等等
	集中式管理：
		redux、dva等等
	conText<span class="token operator">:</span>
		生产者<span class="token operator">-</span>消费者模式
</code></pre></div><h4 id="组件间的关系"><a href="#组件间的关系" class="header-anchor">#</a> 组件间的关系</h4> <div class="language-js extra-class"><pre class="language-js"><code>	父子组件：props
	<span class="token function">兄弟组件</span><span class="token punctuation">(</span>非嵌套组件<span class="token punctuation">)</span>：消息订阅<span class="token operator">-</span>发布、集中式管理
	<span class="token function">祖孙组件</span><span class="token punctuation">(</span>跨级组件<span class="token punctuation">)</span>：消息订阅<span class="token operator">-</span><span class="token function">发布、集中式管理、conText</span><span class="token punctuation">(</span>用的少<span class="token punctuation">)</span>
</code></pre></div><h1 id="_3-1-4-个常用-hooks"><a href="#_3-1-4-个常用-hooks" class="header-anchor">#</a> 3.1 4 个常用 Hooks</h1> <h2 id="为什么会有-hooks"><a href="#为什么会有-hooks" class="header-anchor">#</a> 为什么会有 Hooks？</h2> <p>介绍 Hooks 之前，首先要给大家说一下 React 的组件创建方式，一种是***类组件*<strong>，一种是</strong>*纯函数组件*<strong>，并且 React 团队希望，组件不要变成复杂的容器，最好只是数据流的管道。开发者根据需要，组合管道即可。也就是说</strong>组件的最佳写法应该是函数，而不是类。**。
但是我们知道，在以往开发中<em>类组件</em>和<em>纯函数组件</em>的区别是很大的，纯函数组件有着类组件不具备的多种特点，简单列举几条</p> <ul><li>纯函数组件<strong>没有状态</strong></li> <li>纯函数组件<strong>没有生命周期</strong></li> <li>纯函数组件没有<code>this</code></li> <li>只能是纯函数</li></ul> <p>这就注定，我们所推崇的函数组件，只能做 UI 展示的功能，涉及到状态的管理与切换，我们不得不用类组件或者 redux，但我们知道类组件的也是有缺点的，比如，遇到简单的页面，你的代码会显得很重，并且每创建一个类组件，都要去继承一个 React 实例，至于 Redux,更不用多说，很久之前 Redux 的作者就说过，“能用 React 解决的问题就不用 Redux”,等等一系列的话。关于 React 类组件 redux 的作者又有话说</p> <blockquote><ul><li>大型组件很难拆分和重构，也很难测试。</li> <li>业务逻辑分散在组件的各个方法之中，导致重复逻辑或关联逻辑。</li> <li>组件类引入了复杂的编程模式，比如 render props 和高阶组件。</li></ul></blockquote> <p>下面我们用类组件做一个简单的计数器</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">AddCount</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">addcount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> newCount <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      count<span class="token operator">:</span> <span class="token punctuation">(</span>newCount <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addcount<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">count++</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> AddCount<span class="token punctuation">;</span>
</code></pre></div><p>可以看出来，上面的代码确实很重。
为了解决这种，<em>类组件功能齐全却很重，纯函数很轻便却有上文几点重大限制</em>，React 团队设计了<strong>React Hooks</strong> <strong>*React Hooks 就是加强版的函数组件，我们可以完全不使用 <code>class</code>，就能写出一个全功能的组件*</strong></p> <h2 id="什么是-hooks"><a href="#什么是-hooks" class="header-anchor">#</a> 什么是 Hooks?</h2> <p>'Hooks'的单词意思为“钩子”。
**React Hooks 的意思是，组件尽量写成纯函数，如果需要外部功能和副作用，就用钩子把外部代码&quot;钩&quot;进来。**而 React Hooks 就是我们所说的“钩子”。
那么 Hooks 要怎么用呢？“你需要写什么功能，就用什么钩子”。对于常见的功能，React 为我们提供了一些常用的钩子，当然有特殊需要，我们也可以写自己的钩子。下面是 React 为我们提供的默认的四种最常用钩子</p> <blockquote><ul><li>useState()</li> <li>userContext()</li> <li>userReducer()</li> <li>useEffect()</li></ul></blockquote> <p>不同的钩子为函数引入不同的外部功能，我们发现上面四种钩子都带有<code>use</code>前缀，React 约定，钩子<em>一律使用</em> <code>use</code>前缀命名。所以，你自己定义的钩子都要命名为 useXXX。</p> <h3 id="react-hooks-的用法"><a href="#react-hooks-的用法" class="header-anchor">#</a> React Hooks 的用法</h3> <p>下面介绍四种默认钩子的用法</p> <h2 id="一、userstate-状态钩子"><a href="#一、userstate-状态钩子" class="header-anchor">#</a> 一、userState():状态钩子</h2> <p>我们知道，纯函数组件没有状态，<code>useState()</code>用于为函数组件引入状态。
下面我们使用 Hooks 重写上面的计数器。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">AddCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">addcount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> newCount <span class="token operator">=</span> count<span class="token punctuation">;</span>
    <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span>newCount <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>addcount<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">count++</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> AddCount<span class="token punctuation">;</span>
</code></pre></div><p>通过上面的代码，我们实现了一个功能完全一样的计数器，代码看起来更加的轻便简洁，没有了继承，没有了渲染逻辑，没有了生命周期等。这就是 hooks 存在的意义。
在<code>useState()</code>中，它接受状态的初始值作为参数，即上例中计数的初始值，它返回一个数组，其中数组第一项为一个变量，指向状态的当前值。类似<code>this.state</code>,第二项是一个函数，用来更新状态,类似<code>setState</code>。该函数的命名，我们约定为<code>set</code>前缀加状态的变量名。</p> <h2 id="二、usecontext-共享状态钩子"><a href="#二、usecontext-共享状态钩子" class="header-anchor">#</a> 二、useContext():共享状态钩子</h2> <p>该钩子的作用是，在组件之间共享状态。关于 Context 这里不再赘述，其作用就是可以做状态的分发，在 React16.X 以后支持，避免了 react 逐层通过 Props 传递数据。
下面是一个例子，现在假设有 A 组件和 B 组件需要共享一个状态。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">Ceshi</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> AppContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">A</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>AppContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        我是A组件的名字</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">我是A的子组件</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">B</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>AppContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">我是B组件的名字</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AppContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;hook测试&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">A</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">B</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">AppContext.Provider</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Ceshi<span class="token punctuation">;</span>
</code></pre></div><p>我们可以通过 hooks 做状态的共享。</p> <h2 id="三、usereducer-action-钩子"><a href="#三、usereducer-action-钩子" class="header-anchor">#</a> 三、useReducer():Action 钩子</h2> <p>我们知道，在使用 React 的过程中，如遇到状态管理，我们一般会用到 Redux,而 React 本身是不提供状态管理的。而<code>useReducer()</code>为我们提供了状态管理。首先，关于 redux 我们都知道，其原理是我们通过用户在页面中发起 action,从而通过 reducer 方法来改变 state,从而实现页面和状态的通信。而 Reducer 的形式是<code>(state, action) =&gt; newstate</code>。类似，我们的<code>useReducer()</code>是这样的</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>它接受 reducer 函数和状态的初始值作为参数，返回一个数组，其中第一项为<em>当前的</em>状态值，第二项为发送 action 的 dispatch 函数。下面我们依然用来实现一个计数器。
和 redux 一样，我们是需要通过页面组件发起 action 来调用 reducer 方法，从而改变状态，达到改变页面 UI 的这样一个过程。所以我们会先写一个 Reducer 函数，然后通过 useReducer()返回给我们的 state 和 dispatch 来驱动这个数据流。思路就是这样，下面我们上代码</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">AddCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        count<span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">addcount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>addcount<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">count++</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> AddCount<span class="token punctuation">;</span>
</code></pre></div><p>通过代码我们看到了，我们使用<code>useReducer()</code>代替了 Redux 的功能，但<code>useReducer</code>无法为我们提供中间件等功能，加入你有这些需求，还是需要用到 redux。</p> <h2 id="四、useeffect-副作用钩子"><a href="#四、useeffect-副作用钩子" class="header-anchor">#</a> 四、useEffect():副作用钩子</h2> <p>熟悉 redux-saga 的同学一定对<code>Effect</code>不陌生,它可以用来更好的处理副作用，如异步请求等，我们的<code>useEffect()</code>也是为函数组件提供了处理副作用的钩子。依然我们会把请求房子<code>componentDidMount</code>里面，在函数组件中我们可以使用<code>useEffect()</code>。其具体用法如下</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>array<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>useEffect()</code>接受两个参数，第一个参数是你要进行的异步操作，第二个参数是一个数组，用来给出 Effect 的依赖项。只要这个数组发生变化，<code>useEffect()</code>就会执行。当第二项省略不填时，<code>useEffect()</code>会在每次组件渲染时执行。这一点类似于类组件的<code>componentDidMount</code>。下面我们通过代码模拟一个异步加载数据。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">AsyncPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> loading <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">异步请求完成</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> AsyncPage<span class="token punctuation">;</span>
</code></pre></div><p>上面的代码实现了一个异步加载，下面我们再做一个<code>useEffect()</code>依赖第二项数组变化的例子。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">AsyncPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>person<span class="token punctuation">,</span> setPerson<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>loading <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>person<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">PersonPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">changeName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setState</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AsyncPage</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token string">&quot;名字1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        名字1
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token string">&quot;名字2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        名字2
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PersonPage<span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，通过改变传给<code>AsyncPage</code>的 props,从而调用<code>useEffect()</code>。</p> <h2 id="五、创建自己的-hooks"><a href="#五、创建自己的-hooks" class="header-anchor">#</a> 五、创建自己的 Hooks</h2> <p>以上我们介绍了四种最常用的 react 提供给我们的默认 React Hooks,有时候我们需要创建我们自己想要的 Hooks,来满足更便捷的开发，在小编看来，无非就是根据业务场景对以上四种 Hooks 进行组装，从而得到满足自己需求的钩子。
比如，我们要将我们上面的代码功能封装成 Hooks,代码如下</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">usePerson</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>person<span class="token punctuation">,</span> setPerson<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> person<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">AsyncPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> person<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">usePerson</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>loading <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>person<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">PersonPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">changeName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setState</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AsyncPage</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token string">&quot;名字1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        名字1
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token string">&quot;名字2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        名字2
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PersonPage<span class="token punctuation">;</span>
</code></pre></div><p>上面代码中，我们将之前的例子封装成了自己的 Hooks,便于共享。其中，我们定义<code>usePerson()</code>为我们的自定义 Hooks,它接受一个字符串，返回一个数组，数组中包括两个数据的状态，之后我们在使用<code>usePerson()</code>时，会根据我们传入的参数不同而返回不同的状态，然后很简便的应用于我们的页面中。</p> <p>至此，文章关于 React Hooks 的讲解结束，它为我们带来了 React 翻天覆地的变化，也让我们感受到了 React 的未来，不过，假如你不会 Hooks 也是没有关系的。根据官方文档的话来说</p> <blockquote><ul><li><strong>完全可选的。</strong> 你无需重写任何已有代码就可以在一些组件中尝试 Hook。但是如果你不想，你不必现在就去学习或使用 Hook。</li> <li><strong>100% 向后兼容的。</strong> Hook 不包含任何破坏性改动。</li> <li><strong>现在可用。</strong> Hook 已发布于 v16.8.0。</li> <li><strong>没有计划从 React 中移除 class。</strong></li> <li><strong>Hook 不会影响你对 React 概念的理解。</strong> 恰恰相反，Hook 为已知的 React 概念提供了更直接的 API：props， state，context，refs 以及生命周期。</li></ul></blockquote> <p>本文参考了<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F09%2Freact-hooks.html" target="_blank" rel="noopener noreferrer">阮一峰老师的博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
对 Hooks 感兴趣，想获得更多资料的，还望到<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fzh-hans.reactjs.org%2Fdocs%2Fhooks-intro.html" target="_blank" rel="noopener noreferrer">官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>探索，本文只做抛砖引玉和个人学习交流之用。</p> <h1 id="_3-2-深入-hooks"><a href="#_3-2-深入-hooks" class="header-anchor">#</a> 3.2 深入 Hooks</h1> <h3 id="一、前言"><a href="#一、前言" class="header-anchor">#</a> 一、前言</h3> <p>React Hooks 是从 v16.8 引入的又一开创性的新特性。第一次了解这项特性的时候，真的有一种豁然开朗，发现新大陆的感觉。我深深的为 React 团队天马行空的创造力和精益求精的钻研精神所折服。本文除了介绍具体的用法外，还会分析背后的逻辑和使用时候的注意事项，力求做到知其然也知其所以然。</p> <p>这个系列分上下两篇，这里是上篇的传送门：
<a href="https://segmentfault.com/a/1190000018928587" target="_blank" rel="noopener noreferrer">React Hooks 解析（上）：基础<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="二、uselayouteffect"><a href="#二、uselayouteffect" class="header-anchor">#</a> 二、useLayoutEffect</h3> <p><code>useLayoutEffect</code>的用法跟<code>useEffect</code>的用法是完全一样的，都可以执行副作用和清理操作。它们之间唯一的区别就是执行的时机。</p> <p><code>useEffect</code>不会阻塞浏览器的绘制任务，它在页面更新后才会执行。</p> <p>而<code>useLayoutEffect</code>跟<code>componentDidMount</code>和<code>componentDidUpdate</code>的执行时机一样，会阻塞页面的渲染。如果在里面执行耗时任务的话，页面就会卡顿。</p> <p>在绝大多数情况下，<code>useEffect</code>Hook 是更好的选择。唯一例外的就是需要根据新的 UI 来进行 DOM 操作的场景。<code>useLayoutEffect</code>会保证在页面渲染前执行，也就是说页面渲染出来的是最终的效果。如果使用<code>useEffect</code>，页面很可能因为渲染了 2 次而出现抖动。</p> <h3 id="三、usecontext"><a href="#三、usecontext" class="header-anchor">#</a> 三、useContext</h3> <p><code>useContext</code>可以很方便的去订阅 context 的改变，并在合适的时候重新渲染组件。我们先来熟悉下标准的 context API 用法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">&quot;light&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>ThemeContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token string">&quot;dark&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Toolbar <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 中间层组件</span>
<span class="token keyword">function</span> <span class="token function">Toolbar</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>ThemedButton <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ThemedButton</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// 通过定义静态属性 contextType 来订阅</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> ThemeContext<span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Button theme<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>除了定义静态属性的方式，还有另外一种针对<code>Function Component</code>的订阅方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ThemedButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 通过定义 Consumer 来订阅</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>ThemeContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Button theme<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用<code>useContext</code>来订阅，代码会是这个样子，没有额外的层级和奇怪的模式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ThemedButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>NumberContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Button theme<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在需要订阅多个 context 的时候，就更能体现出<code>useContext</code>的优势。传统的实现方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">HeaderBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>CurrentUser<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token parameter">user</span> <span class="token operator">=&gt;</span>
        <span class="token operator">&lt;</span>Notifications<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token parameter">notifications</span> <span class="token operator">=&gt;</span>
            <span class="token operator">&lt;</span>header<span class="token operator">&gt;</span>
              Welcome back<span class="token punctuation">,</span> <span class="token punctuation">{</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">!</span>
              You have <span class="token punctuation">{</span>notifications<span class="token punctuation">.</span>length<span class="token punctuation">}</span> notifications<span class="token punctuation">.</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>header<span class="token operator">&gt;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>CurrentUser<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>useContext</code>的实现方式更加简洁直观：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">HeaderBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>CurrentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> notifications <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Notifications<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>header<span class="token operator">&gt;</span>
      Welcome back<span class="token punctuation">,</span> <span class="token punctuation">{</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">!</span> You have <span class="token punctuation">{</span>notifications<span class="token punctuation">.</span>length<span class="token punctuation">}</span> notifications<span class="token punctuation">.</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>header<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="四、usereducer"><a href="#四、usereducer" class="header-anchor">#</a> 四、useReducer</h3> <p><code>useReducer</code>的用法跟 Redux 非常相似，当 state 的计算逻辑比较复杂又或者需要根据以前的值来计算时，使用这个 Hook 比<code>useState</code>会更好。下面是一个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">initialCount</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> initialCount <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;increment&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;decrement&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;reset&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">init</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> initialCount <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialCount<span class="token punctuation">,</span> init<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      Count<span class="token operator">:</span> <span class="token punctuation">{</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button
        onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;reset&quot;</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> initialCount <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&gt;</span>
        Reset
      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;increment&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;decrement&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>结合 context API，我们可以模拟 Redux 的操作了，这对组件层级很深的场景特别有用，不需要一层一层的把 state 和 callback 往下传：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> TodosDispatch <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TodosState <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">TodosApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>todosReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>TodosDispatch<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>dispatch<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>TodosState<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>todos<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>DeepTree todos<span class="token operator">=</span><span class="token punctuation">{</span>todos<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>TodosState<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>TodosDispatch<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">DeepChild</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>TodosDispatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> todos <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>TodosState<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>todos<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Add todo<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="五、usecallback-usememo-react-memo"><a href="#五、usecallback-usememo-react-memo" class="header-anchor">#</a> 五、useCallback / useMemo / React.memo</h3> <p><code>useCallback</code>和<code>useMemo</code>设计的初衷是用来做性能优化的。在<code>Class Component</code>中考虑以下的场景：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Click happened&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>Click Me<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>传给 Button 的 onClick 方法每次都是重新创建的，这会导致每次 Foo render 的时候，Button 也跟着 render。优化方法有 2 种，箭头函数和 bind。下面以 bind 为例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Click happened&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click Me<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>同样的，<code>Function Component</code>也有这个问题：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Click happened with dependency: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click Me<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>而 React 给出的方案是<code>useCallback</code> Hook。在依赖不变的情况下 (在我们的例子中是 count )，它会返回相同的引用，避免子组件进行无意义的重复渲染：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> memoizedHandleClick <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Click happened with dependency: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>count<span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Button onClick<span class="token operator">=</span><span class="token punctuation">{</span>memoizedHandleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click Me<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>useCallback</code>缓存的是方法的引用，而<code>useMemo</code>缓存的则是方法的返回值。使用场景是减少不必要的子组件渲染：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当 a 改变时才会重新渲染</span>
  <span class="token keyword">const</span> child1 <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Child1 a<span class="token operator">=</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 当 b 改变时才会重新渲染</span>
  <span class="token keyword">const</span> child2 <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Child2 b<span class="token operator">=</span><span class="token punctuation">{</span>b<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>child1<span class="token punctuation">}</span>
      <span class="token punctuation">{</span>child2<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果想实现<code>Class Component</code>的<code>shouldComponentUpdate</code>方法，可以使用<code>React.memo</code>方法，区别是它只能比较 props，不会比较 state：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Parent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当 a 改变时才会重新渲染</span>
  <span class="token keyword">const</span> child1 <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Child1 a<span class="token operator">=</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 当 b 改变时才会重新渲染</span>
  <span class="token keyword">const</span> child2 <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Child2 b<span class="token operator">=</span><span class="token punctuation">{</span>b<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>child1<span class="token punctuation">}</span>
      <span class="token punctuation">{</span>child2<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="六、useref"><a href="#六、useref" class="header-anchor">#</a> 六、useRef</h3> <p><code>Class Component</code>获取 ref 的方式如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>myRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
​<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">js

Hooks 的实现方式如下：

​</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>js
<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> myRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    myRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span>myRef<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>useRef</code>返回一个普通 JS 对象，可以将任意数据存到<code>current</code>属性里面，就像使用实例化对象的<code>this</code>一样。另外一个使用场景是获取 previous props 或 previous state：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> prevCountRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    prevCountRef<span class="token punctuation">.</span>current <span class="token operator">=</span> count<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> prevCount <span class="token operator">=</span> prevCountRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>
      Now<span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token punctuation">,</span> before<span class="token operator">:</span> <span class="token punctuation">{</span>prevCount<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="七、自定义-hooks"><a href="#七、自定义-hooks" class="header-anchor">#</a> 七、自定义 Hooks</h3> <p>还记得我们上一篇提到的 React 存在的问题吗？其中一点是：</p> <blockquote><p>带组件状态的逻辑很难重用</p></blockquote> <p>通过自定义 Hooks 就能解决这一难题。</p> <p>继续以上一篇文章中订阅朋友状态的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">FriendStatus</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isOnline<span class="token punctuation">,</span> setIsOnline<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">handleStatusChange</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setIsOnline</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>isOnline<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ChatAPI<span class="token punctuation">.</span><span class="token function">subscribeToFriendStatus</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ChatAPI<span class="token punctuation">.</span><span class="token function">unsubscribeFromFriendStatus</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isOnline <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Loading...&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> isOnline <span class="token operator">?</span> <span class="token string">&quot;Online&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Offline&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>假设现在我有另一个组件有类似的逻辑，当朋友上线的时候展示为绿色。简单的复制粘贴虽然可以实现需求，但太不优雅：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">FriendListItem</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isOnline<span class="token punctuation">,</span> setIsOnline<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">handleStatusChange</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setIsOnline</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>isOnline<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ChatAPI<span class="token punctuation">.</span><span class="token function">subscribeToFriendStatus</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ChatAPI<span class="token punctuation">.</span><span class="token function">unsubscribeFromFriendStatus</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>li style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token operator">:</span> isOnline <span class="token operator">?</span> <span class="token string">&quot;green&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;black&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时我们就可以自定义一个 Hook 来封装订阅的逻辑：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span><span class="token parameter">friendID</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isOnline<span class="token punctuation">,</span> setIsOnline<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">handleStatusChange</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setIsOnline</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>isOnline<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ChatAPI<span class="token punctuation">.</span><span class="token function">subscribeToFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ChatAPI<span class="token punctuation">.</span><span class="token function">unsubscribeFromFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> isOnline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>自定义 Hook 的命名有讲究，必须以<code>use</code>开头，在里面可以调用其它的 Hook。入参和返回值都可以根据需要自定义，没有特殊的约定。使用也像普通的函数调用一样，Hook 里面其它的 Hook（如<code>useEffect</code>）会自动在合适的时候调用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">FriendStatus</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isOnline <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Loading...&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> isOnline <span class="token operator">?</span> <span class="token string">&quot;Online&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Offline&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">FriendListItem</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>li style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token operator">:</span> isOnline <span class="token operator">?</span> <span class="token string">&quot;green&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;black&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>friend<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>自定义 Hook 其实就是一个普通的函数定义，以<code>use</code>开头来命名也只是为了方便静态代码检测，不以它开头也完全不影响使用。在此不得不佩服 React 团队的巧妙设计。</p> <h3 id="八、hooks-使用规则"><a href="#八、hooks-使用规则" class="header-anchor">#</a> 八、Hooks 使用规则</h3> <p>使用 Hooks 的时候必须遵守 2 条规则：</p> <ul><li>只能在代码的第一层调用 Hooks，不能在循环、条件分支或者嵌套函数中调用 Hooks。</li> <li>只能在<code>Function Component</code>或者自定义 Hook 中调用 Hooks，不能在普通的 JS 函数中调用。</li></ul> <p>Hooks 的设计极度依赖其定义时候的顺序，如果在后序的 render 中 Hooks 的调用顺序发生变化，就会出现不可预知的问题。上面 2 条规则都是为了保证 Hooks 调用顺序的稳定性。为了贯彻这 2 条规则，React 提供一个 ESLint plugin 来做静态代码检测：<a href="https://www.npmjs.com/package/eslint-plugin-react-hooks" target="_blank" rel="noopener noreferrer">eslint-plugin-react-hooks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="九、总结"><a href="#九、总结" class="header-anchor">#</a> 九、总结</h3> <p>本文深入介绍了 6 个 React 预定义 Hook 的使用方法和注意事项，并讲解了如何自定义 Hook，以及使用 Hooks 要遵循的一些约定。到此为止，Hooks 相关的内容已经介绍完了，内容比我刚开始计划的要多不少，想要彻底理解 Hooks 的设计是需要投入相当精力的，希望本文可以为你学习这一新特性提供一些帮助。</p> <h1 id="_3-3-useeffect"><a href="#_3-3-useeffect" class="header-anchor">#</a> 3.3 useEffect</h1> <h2 id="useeffect-和生命周期"><a href="#useeffect-和生命周期" class="header-anchor">#</a> useEffect 和生命周期</h2> <p><code>useEffect</code>会在每次 DOM 渲染后执行，不会阻塞页面渲染。它同时具备<code>componentDidMount</code>、<code>componentDidUpdate</code>和<code>componentWillUnmount</code>三个生命周期函数的执行时机。</p> <p>此外还有一些副作用需要组件卸载的时候做一些额外的清理工作的，例如订阅某个功能：</p> <h2 id="五、useeffect-的用法"><a href="#五、useeffect-的用法" class="header-anchor">#</a> 五、useEffect() 的用法</h2> <p><code>useEffect()</code>本身是一个函数，由 React 框架提供，在函数组件内部调用即可。</p> <p>举例来说，我们希望组件加载以后，网页标题（<code>document.title</code>）会随之改变。那么，改变网页标题这个操作，就是组件的副效应，必须通过<code>useEffect()</code>来实现。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Welcome</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&quot;加载完成&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面例子中，<code>useEffect()</code>的参数是一个函数，它就是所要完成的副效应（改变网页标题）。组件加载以后，React 就会执行这个函数。</p> <p><code>useEffect()</code>的作用就是指定一个副效应函数，组件每渲染一次，该函数就自动执行一次。组件首次在网页 DOM 加载后，副效应函数也会执行。</p> <h2 id="六、useeffect-的第二个参数"><a href="#六、useeffect-的第二个参数" class="header-anchor">#</a> 六、useEffect() 的第二个参数</h2> <p>有时候，我们不希望<code>useEffect()</code>每次渲染都执行，这时可以使用它的第二个参数，使用一个数组指定副效应函数的依赖项，只有依赖项发生变化，才会重新渲染。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Welcome</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面例子中，<code>useEffect()</code>的第二个参数是一个数组，指定了第一个参数（副效应函数）的依赖项（<code>props.name</code>）。只有该变量发生变化时，副效应函数才会执行。</p> <p>如果第二个参数是一个空数组，就表明副效应参数没有任何依赖项。因此，副效应函数这时只会在组件加载进入 DOM 后执行一次，后面组件重新渲染，就不会再次执行。这很合理，由于副效应不依赖任何变量，所以那些变量无论怎么变，副效应函数的执行结果都不会改变，所以运行一次就够了。</p> <h2 id="七、useeffect-的用途"><a href="#七、useeffect-的用途" class="header-anchor">#</a> 七、useEffect() 的用途</h2> <p>只要是副效应，都可以使用<code>useEffect()</code>引入。它的常见用途有下面几种。</p> <ul><li>获取数据（data fetching）</li> <li>事件监听或订阅（setting up a subscription）</li> <li>改变 DOM（changing the DOM）</li> <li>输出日志（logging）</li></ul> <p>下面是从远程服务器获取数据的例子。（<a href="https://codesandbox.io/s/intelligent-yonath-olihz?file=/src/index.js" target="_blank" rel="noopener noreferrer">查看运行结果<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hits<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fetchData <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span>
        <span class="token string">&quot;https://hn.algolia.com/api/v1/search?query=redux&quot;</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setData</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>ul
      <span class="token punctuation">{</span>data<span class="token punctuation">.</span>hits<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>objectID<span class="token punctuation">}</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>url<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
     <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
 <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre></div><p>上面例子中，<code>useState()</code>用来生成一个状态变量（<code>data</code>），保存获取的数据；<code>useEffect()</code>的副效应函数内部有一个 async 函数，用来从服务器异步获取数据。拿到数据以后，再用<code>setData()</code>触发组件的重新渲染。</p> <p>由于获取数据只需要执行一次，所以上例的<code>useEffect()</code>的第二个参数为一个空数组。</p> <h2 id="八、useeffect-的返回值"><a href="#八、useeffect-的返回值" class="header-anchor">#</a> 八、useEffect() 的返回值</h2> <p>副效应是随着组件加载而发生的，那么组件卸载时，可能需要清理这些副效应。</p> <p><code>useEffect()</code>允许返回一个函数，在组件卸载时，执行该函数，清理副效应。如果不需要清理副效应，<code>useEffect()</code>就不用返回任何值。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> subscription <span class="token operator">=</span> props<span class="token punctuation">.</span>source<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    subscription<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">.</span>source<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面例子中，<code>useEffect()</code>在组件加载时订阅了一个事件，并且返回一个清理函数，在组件卸载时取消订阅。</p> <p>实际使用中，由于副效应函数默认是每次渲染都会执行，所以清理函数不仅会在组件卸载时执行一次，每次副效应函数重新执行之前，也会执行一次，用来清理上一次渲染的副效应。</p> <h2 id="九、useeffect-的注意点"><a href="#九、useeffect-的注意点" class="header-anchor">#</a> 九、useEffect() 的注意点</h2> <p>使用<code>useEffect()</code>时，有一点需要注意。如果有多个副效应，应该调用多个<code>useEffect()</code>，而不应该合并写在一起。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>varA<span class="token punctuation">,</span> setVarA<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>varB<span class="token punctuation">,</span> setVarB<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> timeoutA <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setVarA</span><span class="token punctuation">(</span>varA <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> timeoutB <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setVarB</span><span class="token punctuation">(</span>varB <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutA<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutB<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>varA<span class="token punctuation">,</span> varB<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>varA<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>varB<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的例子是错误的写法，副效应函数里面有两个定时器，它们之间并没有关系，其实是两个不相关的副效应，不应该写在一起。正确的写法是将它们分开写成两个<code>useEffect()</code>。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>varA<span class="token punctuation">,</span> setVarA<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>varB<span class="token punctuation">,</span> setVarB<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setVarA</span><span class="token punctuation">(</span>varA <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>varA<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setVarB</span><span class="token punctuation">(</span>varB <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>varB<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>varA<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>varB<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十、参考链接"><a href="#十、参考链接" class="header-anchor">#</a> 十、参考链接</h2> <ul><li><a href="https://medium.com/swlh/useeffect-4-tips-every-developer-should-know-54b188b14d9c" target="_blank" rel="noopener noreferrer">React useEffect: 4 Tips Every Developer Should Know<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Helder Esteves</li> <li><a href="https://reactjs.org/docs/hooks-effect.html" target="_blank" rel="noopener noreferrer">Using the Effect Hook<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, React</li> <li><a href="https://www.robinwieruch.de/react-hooks-fetch-data" target="_blank" rel="noopener noreferrer">How to fetch data with React Hooks?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Robin Wieruch</li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/React/ReactBase/dRouter.html">
            4.关于 Router
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#hooks-的由来" class="sidebar-link reco-side-hooks-的由来" data-v-70334359>Hooks 的由来</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#在组件之间复用状态逻辑很难" class="sidebar-link reco-side-在组件之间复用状态逻辑很难" data-v-70334359>在组件之间复用状态逻辑很难</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#复杂组件变得难以理解" class="sidebar-link reco-side-复杂组件变得难以理解" data-v-70334359>复杂组件变得难以理解</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#解决问题而出现" class="sidebar-link reco-side-解决问题而出现" data-v-70334359>解决问题而出现</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_1-setstate-更新状态的-2-种写法" class="sidebar-link reco-side-_1-setstate-更新状态的-2-种写法" data-v-70334359>1. setState 更新状态的 2 种写法</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_2-lazyload" class="sidebar-link reco-side-_2-lazyload" data-v-70334359>2. lazyLoad</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#路由组件的-lazyload" class="sidebar-link reco-side-路由组件的-lazyload" data-v-70334359>路由组件的 lazyLoad</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_3-hooks" class="sidebar-link reco-side-_3-hooks" data-v-70334359>3. Hooks</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_4-fragment" class="sidebar-link reco-side-_4-fragment" data-v-70334359>4. Fragment</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#使用" class="sidebar-link reco-side-使用" data-v-70334359>使用</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#作用" class="sidebar-link reco-side-作用" data-v-70334359>作用</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_5-context" class="sidebar-link reco-side-_5-context" data-v-70334359>5. Context</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#理解" class="sidebar-link reco-side-理解" data-v-70334359>理解</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#使用-2" class="sidebar-link reco-side-使用-2" data-v-70334359>使用</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#注意" class="sidebar-link reco-side-注意" data-v-70334359>注意</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_6-组件优化" class="sidebar-link reco-side-_6-组件优化" data-v-70334359>6. 组件优化</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#component-的-2-个问题" class="sidebar-link reco-side-component-的-2-个问题" data-v-70334359>Component 的 2 个问题</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#效率高的做法" class="sidebar-link reco-side-效率高的做法" data-v-70334359>效率高的做法</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#原因" class="sidebar-link reco-side-原因" data-v-70334359>原因</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#解决" class="sidebar-link reco-side-解决" data-v-70334359>解决</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_7-render-props" class="sidebar-link reco-side-_7-render-props" data-v-70334359>7. render props</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#如何向组件内部动态传入带内容的结构-标签" class="sidebar-link reco-side-如何向组件内部动态传入带内容的结构-标签" data-v-70334359>如何向组件内部动态传入带内容的结构(标签)?</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#children-props" class="sidebar-link reco-side-children-props" data-v-70334359>children props</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#render-props" class="sidebar-link reco-side-render-props" data-v-70334359>render props</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_8-错误边界" class="sidebar-link reco-side-_8-错误边界" data-v-70334359>8. 错误边界</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#_9-组件通信方式总结" class="sidebar-link reco-side-_9-组件通信方式总结" data-v-70334359>9. 组件通信方式总结</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#为什么会有-hooks" class="sidebar-link reco-side-为什么会有-hooks" data-v-70334359>为什么会有 Hooks？</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#什么是-hooks" class="sidebar-link reco-side-什么是-hooks" data-v-70334359>什么是 Hooks?</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#react-hooks-的用法" class="sidebar-link reco-side-react-hooks-的用法" data-v-70334359>React Hooks 的用法</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#一、userstate-状态钩子" class="sidebar-link reco-side-一、userstate-状态钩子" data-v-70334359>一、userState():状态钩子</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#二、usecontext-共享状态钩子" class="sidebar-link reco-side-二、usecontext-共享状态钩子" data-v-70334359>二、useContext():共享状态钩子</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#三、usereducer-action-钩子" class="sidebar-link reco-side-三、usereducer-action-钩子" data-v-70334359>三、useReducer():Action 钩子</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#四、useeffect-副作用钩子" class="sidebar-link reco-side-四、useeffect-副作用钩子" data-v-70334359>四、useEffect():副作用钩子</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#五、创建自己的-hooks" class="sidebar-link reco-side-五、创建自己的-hooks" data-v-70334359>五、创建自己的 Hooks</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#一、前言" class="sidebar-link reco-side-一、前言" data-v-70334359>一、前言</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#二、uselayouteffect" class="sidebar-link reco-side-二、uselayouteffect" data-v-70334359>二、useLayoutEffect</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#三、usecontext" class="sidebar-link reco-side-三、usecontext" data-v-70334359>三、useContext</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#四、usereducer" class="sidebar-link reco-side-四、usereducer" data-v-70334359>四、useReducer</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#五、usecallback-usememo-react-memo" class="sidebar-link reco-side-五、usecallback-usememo-react-memo" data-v-70334359>五、useCallback / useMemo / React.memo</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#六、useref" class="sidebar-link reco-side-六、useref" data-v-70334359>六、useRef</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#七、自定义-hooks" class="sidebar-link reco-side-七、自定义-hooks" data-v-70334359>七、自定义 Hooks</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#八、hooks-使用规则" class="sidebar-link reco-side-八、hooks-使用规则" data-v-70334359>八、Hooks 使用规则</a></li><li class="level-3" data-v-70334359><a href="/React/ReactBase/cHooks.html#九、总结" class="sidebar-link reco-side-九、总结" data-v-70334359>九、总结</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#useeffect-和生命周期" class="sidebar-link reco-side-useeffect-和生命周期" data-v-70334359>useEffect 和生命周期</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#五、useeffect-的用法" class="sidebar-link reco-side-五、useeffect-的用法" data-v-70334359>五、useEffect() 的用法</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#六、useeffect-的第二个参数" class="sidebar-link reco-side-六、useeffect-的第二个参数" data-v-70334359>六、useEffect() 的第二个参数</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#七、useeffect-的用途" class="sidebar-link reco-side-七、useeffect-的用途" data-v-70334359>七、useEffect() 的用途</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#八、useeffect-的返回值" class="sidebar-link reco-side-八、useeffect-的返回值" data-v-70334359>八、useEffect() 的返回值</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#九、useeffect-的注意点" class="sidebar-link reco-side-九、useeffect-的注意点" data-v-70334359>九、useEffect() 的注意点</a></li><li class="level-2" data-v-70334359><a href="/React/ReactBase/cHooks.html#十、参考链接" class="sidebar-link reco-side-十、参考链接" data-v-70334359>十、参考链接</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.5b821b5b.js" defer></script><script src="/assets/js/3.bc729665.js" defer></script><script src="/assets/js/1.70674a6e.js" defer></script><script src="/assets/js/367.8febf30a.js" defer></script>
  </body>
</html>
